<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Insert title here</title>
<link rel="shortcut" href="../image/icon2.png">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr"
	crossorigin="anonymous">
<style>
#item-template {
	display: none;
}

#map {
	height: 500px;
}
</style>
</head>
<body>
	<h3 class="text-center mb-2">한국농어촌공사에서 제공하는 계절 테마여행 세부 코스정보</h3>
	<div class="container mb-3">
		<div class="p-5 text-center bg-body-tertiary rounded-3">
			<div id="map"></div>
		</div>
	</div>

	<div class="container">
		<div id="list" class="row row-cols-1 row-cols-md-3 g-4">
			<div id="item-template" class="col">
				<div class="card">
					<img class="card-img-top">
					<div class="card-body">
						<h5 class="card-title fw-bold"></h5>
						<p class="card-text"></p>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script src="../js/jquery-3.7.1.min.js"></script>
	<script
		src="//dapi.kakao.com/v2/maps/sdk.js?appkey=d34d60c4bf6194c59f72cfe131a9ca7d"></script>
	<script>
		const template = function(no, destinationName, photoFile, lat, lng,
				address) {
			let $div = $('#list');

			let $element = $('#item-template').clone().removeAttr('id');
			$element.find('.card-img-top').attr({
				"src" : photoFile,
				"data-lat" : lat,
				"data-lng" : lng
			});

			$element.find('.card-title').html(destinationName);
			$element.find('.card-text').html(address);

			$div.append($element);
		}
		
		function initMap(lat, lng){
			const container = document.getElementById('map');
			
			const option = {
					center: new kakao.maps.LatLng(lat, lng),
					lever: 5
			};
			
			const map = new kakao.maps.Map(container, option);
			
			let mapTypeControl = new kakao.maps.MapTypeControl();
			map.addControl(mapTypeControl, kakao.maps.ControlPosition.TOPRIGHT);
			
			let zoomControl = new kakao.maps.ZoomControl();
			map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);
			    
			let marker = new kakao.maps.Marker({
			    position: map.getCenter()
			});
			marker.setMap(map);
		}
		
		$.ajax({
			url:'/firstExample/ajax/json/krc_data.json',
			method:'get',
			dataType:'json'
		}).done(function(json){
			$(json).each(function(index){
				if(index < 21){
					let no =this.no;
					let destinationName = this.destinationName;
					let photoFile = this.photoFile;
					let lat = this.latitude;
					let lng = this.longitude;
					let address = this.address;
					
					template(no, destinationName, photoFile, lat, lng, address);
				}
			});
		}).fail(function(xhr, textStatus){
			alert(textStatus + "(HTTP-" + xhr.status + ")");
		});
		
		$(document).on("click", ".card-img-top", function(){
			let lat = $(this).data("lat");
			let lng = $(this).data("lng");
			console.log(lat, lng);
			initMap(lat,lng);
		});
	</script>
</body>
</html>